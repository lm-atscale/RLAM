unique_name: SECURITY_POSITION_Aggregate
object_type: dataset
label: SECURITY_POSITION
columns:
  - name: HSBC_FUND_CODE
    data_type: string
  - name: POSITION_DATE
    data_type: date
  - name: AGG_MARKET_VALUE_DIRTY_IN_FUND_CURRENCY
    data_type: decimal(38,10)
  - name: AGG_ACCRUED_INTEREST_IN_FUND_CURRENCY
    data_type: decimal(38,10)
  - name: AGG_PRICE_CLEAN_IN_FUND_CURRENCY
    data_type: decimal(38,11)
  - name: AGG_MBO_PRICE_IN_LOCAL_CURRENCY
    data_type: decimal(38,11)
connection_id: con_SE_DEMO_LIBRARY_RLAM_POV
sql: >-

  SELECT  


  HSBC_FUND_CODE,

  POSITION_DATE,

  SUM(MARKET_VALUE_DIRTY_IN_FUND_CURRENCY) AS
  AGG_MARKET_VALUE_DIRTY_IN_FUND_CURRENCY,

  SUM(ACCRUED_INTEREST_IN_FUND_CURRENCY) AS
  AGG_ACCRUED_INTEREST_IN_FUND_CURRENCY,

  SUM(PRICE_CLEAN_IN_FUND_CURRENCY) AS AGG_PRICE_CLEAN_IN_FUND_CURRENCY,

  SUM(MBO_PRICE_IN_LOCAL_CURRENCY) AS AGG_MBO_PRICE_IN_LOCAL_CURRENCY
        
  FROM   SE_DEMO_LIBRARY.RLAM_POV.SECURITY_POSITION


  WHERE   WEIGHT <> 0 AND HSBC_FUND_CODE = 'RLACTPLRPF'


  GROUP BY 


  HSBC_FUND_CODE,

  POSITION_DATE
